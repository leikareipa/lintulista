"use strict";import{panic_if_not_type,warn,throw_if_not_true}from"../../assert.js";export function MenuButton(a={}){function b(b,c){return a.items.length?void(h(a.items[b].text),f(!1),c()):void warn("Received a click on an item even though there are no items.")}function c(){f(!1)}function d(){(a.items.length||a.customMenu)&&f(!0)}MenuButton.validate_props(a);const[e,f]=React.useState(!1),[g,h]=React.useState(a.items.length?a.items[a.initialItemIdx].text:"null");React.useEffect(()=>{function b(b){const f=(()=>{for(let c=b.target;c;){if(c.dataset&&c.dataset.menuButtonId===a.id)return!0;c=c.parentNode}return!1})(),g=!!(f&&b.target.classList&&b.target.classList.contains("item")),h=!!(f&&b.target.classList&&b.target.classList.contains("title")),i=(()=>{if(!a.customMenu)return!1;for(let a=b.target;a;){if(a.classList&&a.classList.contains("custom-menu"))return!0;a=a.parentNode}return!1})();f?!g&&!h&&!i&&(e?c():d(),a.callbackOnButtonClick()):c()}return window.addEventListener("mousedown",b),()=>{window.removeEventListener("mousedown",b)}});const i=a.items.map((a,c)=>React.createElement("div",{key:a.text+c,className:"item",onClick:()=>b(c,a.callbackOnSelect)},a.text)),j=(()=>a.customMenu?React.createElement("div",{className:`dropdown custom-menu ${e?"active":"inactive"}`},a.customMenu):a.items.length?React.createElement("div",{className:`dropdown ${e?"active":"inactive"}`},React.createElement("div",{className:"items"},a.title.length?React.createElement("div",{className:"title"},a.title):React.createElement(React.Fragment,null),i)):React.createElement(React.Fragment,null))();return React.createElement("div",{className:`MenuButton ${a.enabled?"enabled":"disabled"} ${a.id}`,"data-menu-button-id":a.id},React.createElement("div",{className:"tooltip",style:{display:a.showTooltip?"initial":"none"}},g),React.createElement("div",{className:`icon ${e?"active":"inactive"}`.trim(),title:a.title},React.createElement("i",{className:a.icon})),j)}MenuButton.defaultProps={id:"undefined-menu-button",title:"?",icon:"fas fa-question",items:[],enabled:!0,initialItemIdx:0,showTooltip:!0,callbackOnButtonClick:()=>{},customMenu:!1},MenuButton.validate_props=function(a){return panic_if_not_type("object",a,a.items),void panic_if_not_type("string",a.title,a.id)},MenuButton.test=()=>{let a={remove:()=>{}};try{a=document.createElement("div"),document.body.appendChild(a),ReactTestUtils.act(()=>{const b=React.createElement(MenuButton,{icon:"fas fa-list-ul fa-fw",title:"Title1",id:"Test-Menu",items:[{text:"Option1",callbackOnSelect:()=>{}},{text:"Option2",callbackOnSelect:()=>{}}],initialItemIdx:1,showTooltip:!1});ReactDOM.unmountComponentAtNode(a),ReactDOM.render(b,a)});const b=a.querySelector(".MenuButton"),c=b.querySelector(".tooltip"),d=b.querySelector(".icon"),e=b.querySelector(".dropdown"),f=e.querySelector(".items");throw_if_not_true([()=>null!==b,()=>null!==d,()=>null!==c,()=>null!==e,()=>b.classList.contains("Test-Menu"),()=>b.classList.contains("enabled"),()=>"none"===c.style.display,()=>"Option2"===c.textContent,()=>"Title1"===d.getAttribute("title"),()=>e.classList.contains("inactive"),()=>null!==f.querySelector(".title"),()=>"Title1"===f.querySelector(".title").textContent,()=>2===f.querySelectorAll(".item").length,()=>"Option1"===f.querySelectorAll(".item")[0].textContent,()=>"Option2"===f.querySelectorAll(".item")[1].textContent])}catch(a){if("assertion failure"===a)return!1;throw a}finally{a.remove()}try{a=document.createElement("div"),document.body.appendChild(a),ReactTestUtils.act(()=>{const b=React.createElement(MenuButton,{icon:"fas fa-list-ul fa-fw",title:"Title1",id:"Test-Menu",items:[{text:"Option1",callbackOnSelect:()=>{}},{text:"Option2",callbackOnSelect:()=>{}}],initialItemIdx:1,showTooltip:!0});ReactDOM.unmountComponentAtNode(a),ReactDOM.render(b,a)});const b=a.querySelector(".tooltip");throw_if_not_true([()=>null!==b,()=>"none"!==b.style.display,()=>"Option2"===b.textContent])}catch(a){if("assertion failure"===a)return!1;throw a}finally{a.remove()}try{a=document.createElement("div"),document.body.appendChild(a),ReactTestUtils.act(()=>{const b=React.createElement(MenuButton,{icon:"fas fa-list-ul fa-fw",title:"Title1",id:"Test-Menu",customMenu:React.createElement("div",{id:"Custom1"},"Hello there."),initialItemIdx:1,showTooltip:!0});ReactDOM.unmountComponentAtNode(a),ReactDOM.render(b,a)});const b=a.querySelector(".tooltip"),c=a.querySelector(".dropdown"),d=a.querySelector(".icon");throw_if_not_true([()=>null!==b,()=>null!==c,()=>null!==d,()=>"Title1"===d.getAttribute("title"),()=>1===c.childNodes.length,()=>c.classList.contains("custom-menu")]);const e=c.childNodes[0];throw_if_not_true([()=>null!==e,()=>"Custom1"===e.getAttribute("id"),()=>"Hello there."===e.textContent])}catch(a){if("assertion failure"===a)return!1;throw a}finally{a.remove()}return!0};