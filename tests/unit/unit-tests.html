<!DOCTYPE html>
<html>
    <head>
        <title>Lintulista - unit test results</title>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" integrity="sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="unit-tests.css">
    </head>
    <body>
        <div id="title">
            Lintulista - unit test results
        </div>

        <div id="overall-result">
            <!-- An icon indicating whether all results succeeded or some failed will appear here.-->
        </div>

        <br>
        <div id="individual-results">
            <!-- The names of the individual units tested will appear here.-->
        </div>

        <br>
        <div id="finish-date">
            <!-- The time and date at which the tests finished will appear here.-->
        </div>

        <script src="../../client/react/react.js"></script>
        <script src="../../client/react/react-dom.js"></script>
        <script src="../../client/react/react-dom-test-utils.js"></script>
        <script type="module">
            import {BirdSearchResult} from "../../client/dist/react-components/bird-search/BirdSearchResult.js";
            import {AsyncIconButton} from "../../client/dist/react-components/buttons/AsyncIconButton.js";
            import {BirdSearchBar} from "../../client/dist/react-components/bird-search/BirdSearchBar.js";
            import {ScrollerLabel} from "../../client/dist/react-components/scroller-label/ScrollerLabel.js";
            import {BirdThumbnail} from "../../client/dist/react-components/misc/BirdThumbnail.js";
            import {Observation} from "../../client/dist/observation.js";
            import {BirdSearch} from "../../client/dist/react-components/bird-search/BirdSearch.js";
            import {Bird} from "../../client/dist/bird.js";

            const unitTestResults =
            [
                {unitName:"Bird", passes:Bird.test()},
                {unitName:"Observation", passes:Observation.test()},
                {unitName:"ScrollerLabel", passes:ScrollerLabel.test()},
                {unitName:"BirdThumbnail", passes:BirdThumbnail.test()},
                {unitName:"AsyncIconButton", passes:AsyncIconButton.test()},
                {unitName:"BirdSearchBar", passes:BirdSearchBar.test()},
                {unitName:"BirdSearchResult", passes:BirdSearchResult.test()},
                {unitName:"BirdSearch", passes:BirdSearch.test()},
            ];

            document.getElementById("overall-result").classList.add(unitTestResults.some(test=>!test.passes)? "fail" : "pass");

            unitTestResults.forEach((result, idx)=>
            {
                const nameElement = document.createElement("span");
                nameElement.style.whiteSpace = "nowrap";

                if (result.passes)
                {
                    nameElement.className = "pass";
                }
                else
                {
                    nameElement.className = "fail";
                    nameElement.setAttribute("title", `${result.unitName} fails`);
                }

                nameElement.appendChild(document.createTextNode(result.unitName));
                document.getElementById("individual-results").appendChild(nameElement);

                if (idx < (unitTestResults.length - 1))
                {
                    document.getElementById("individual-results").appendChild(document.createTextNode(", "));
                }
            });

            document.getElementById("finish-date").appendChild(document.createTextNode(Date()));
        </script>
    </body>
</html>
